import csv
import sqlite3

# Define the CSV file path and SQLite database file path
CSV_FILE_PATH = 'C:\\yakuta\\Cybersecurity\\CVE_DATABASE - CVE_DATABASE.csv'
DATABASE_FILE_PATH = 'cve_database.db'

# Function to create database table
def create_table(cursor):
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS cve_data (
            id INTEGER PRIMARY KEY,
            cve_id TEXT,
            severity TEXT,
            cvss TEXT,
            affected_packages TEXT,
            description TEXT,
            cwe_id TEXT
        )
    ''')

# Function to insert data into the database
def insert_data(cursor, data):
    cursor.executemany('''
        INSERT INTO cve_data (cve_id, severity, cvss, affected_packages, description, cwe_id)
        VALUES (?, ?, ?, ?, ?, ?)
    ''', data)

# Main function to import data from CSV to database
def main():
    # Connect to SQLite database
    conn = sqlite3.connect(DATABASE_FILE_PATH)
    cursor = conn.cursor()

    # Create database table
    create_table(cursor)

    # Read data from CSV file and insert into database
    with open(CSV_FILE_PATH, 'r', newline='', encoding='utf-8') as csvfile:
        csvreader = csv.reader(csvfile)
        # Skip header row
        next(csvreader)
        data = [tuple(row) for row in csvreader]  # Convert rows to tuples
        insert_data(cursor, data)

    # Commit changes and close connection
    conn.commit()
    conn.close()

if __name__ == '__main__':
    main()
